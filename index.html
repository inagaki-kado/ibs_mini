<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ITABASHI BEYBLADE HUD - Ver.28.3 Auto Save</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:ital,wght@1,700&family=Orbitron:wght@900&display=swap" rel="stylesheet">

    <style>
        /* ▼▼▼ フォント設定 ▼▼▼ */
        @font-face { font-family: 'DSEG7 Classic'; src: url('./font/DSEG7Classic-BoldItalic.ttf') format('truetype'); font-weight: bold; font-style: italic; }

        :root {
            --bx-green: #b6ff00; --bx-blue: #00eaff; --bx-orange: #ffaa00;
            --bx-red-orange: #ff4500; --bx-red: #ff0055;
            --bx-yellow: #fff000;
            --safe-left: env(safe-area-inset-left); --safe-right: env(safe-area-inset-right);
        }

        body { 
            margin: 0; padding: 0; background: black; 
            font-family: 'Chakra Petch', sans-serif; overflow: hidden; color: white; 
            -webkit-tap-highlight-color: transparent; transition: background-color 0.3s;
            touch-action: none; 
        }

        input, button, .score, .hud-btn, .system-btn { font-family: inherit; }
        body.green-mode { background-color: #00ff00 !important; }
        
        #video-container { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1; overflow: hidden; }
        #camera-bg, #replay-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; transform-origin: center center; }
        #replay-video { z-index: 10; display: none; background: black; }
        .scan-line { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 2; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 0, 0, 0.03) 3px); pointer-events: none; }

        /* システムボタン */
        .system-btn { 
            position: fixed; z-index: 80; background: rgba(0,0,0,0.5); color: #aaa; border: 1px solid #555; 
            width: 45px; height: 45px; display: flex; justify-content: center; align-items: center;
            font-size: 14px; font-weight: 900; cursor: pointer; border-radius: 8px; outline: none; transition: 0.3s;
            font-family: 'Orbitron', sans-serif !important;
        }
        .system-btn:hover { color: var(--bx-green); border-color: var(--bx-green); }
        .btn-reset { top: 20px; left: max(20px, calc(var(--safe-left) + 20px)); } 
        .btn-bg { bottom: 20px; left: max(20px, calc(var(--safe-left) + 20px)); }
        .btn-rotate { bottom: 20px; left: max(80px, calc(var(--safe-left) + 75px)); color: var(--bx-blue); border-color: var(--bx-blue); }
        .btn-mic { bottom: 20px; left: max(140px, calc(var(--safe-left) + 130px)); }
        .btn-mic.active { color: white; background: var(--bx-red); border-color: white; box-shadow: 0 0 10px var(--bx-red); }
        .btn-timer { top: 20px; right: max(20px, calc(var(--safe-right) + 20px)); } 
        .btn-timer-toggle { top: 20px; right: max(80px, calc(var(--safe-right) + 75px)); color: var(--bx-blue); }
        .btn-winpoint { bottom: 20px; right: max(20px, calc(var(--safe-right) + 20px)); color: var(--bx-orange); font-size: 18px; }
        body.pro-mode .system-btn { display: none !important; }

        /* HUD要素 */
        #battle-counter-area { position: fixed; top: 25px; left: 50%; transform: translateX(-50%); z-index: 80; text-align: center; font-family: 'Orbitron', sans-serif !important; pointer-events: none; transition: 0.3s; }
        body.pro-mode #battle-counter-area { top: 15px; }
        .battle-ordinal { font-size: 32px; font-weight: 900; color: var(--bx-yellow); text-shadow: 0 0 15px rgba(255, 242, 0, 0.6), 2px 2px 0 black; margin-right: 5px; }
        .battle-label { font-size: 20px; font-weight: 900; color: white; text-shadow: 1px 1px 0 black; }
        
        #tournament-title-area { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); z-index: 80; display: flex; flex-direction: column; align-items: center; width: 60%; transition: 0.3s; pointer-events: none; }
        .tournament-input { font-family: 'Chakra Petch', sans-serif !important; font-size: 16px; font-weight: 700; font-style: italic; color: rgba(255, 255, 255, 0.6); text-shadow: